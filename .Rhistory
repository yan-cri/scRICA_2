head(*Idents(seuratObjFinal))
head(Idents(seuratObjFinal))
head(factor(paste(Idents(seuratObjFinal), seuratObjFinal$expCond, sep = '_'), levels = paste(rep(levels(Idents(seuratObjFinal)), each = length(levels(factor(seuratObjFinal$expCond))) ), levels(factor(seuratObjFinal$expCond, levels = expCondReorderLevels)), sep = '_') ))
seuratObjFinal <- seuratObjFinalOrg
expCondCheck = 'expCond1'
head(seuratObjFinal)
## ------
if (expCondCheck == 'sample') {
seuratObjFinal                     <- seuratObjFinal
} else if (expCondCheck == 'comb') {
seuratObjFinal@meta.data$expCond   <- Idents(seuratObjFinal)
} else if (expCondCheck == 'expCond1') {
if (!'expCond1' %in% colnames(seuratObjFinal@meta.data)){
print("Error: 'expCond1' has not been included in the original integration analysis.")
seuratObjFinal@meta.data$expCond <- gsub(pattern = as.character(expCondName2change), replacement = '', x = seuratObjFinal@meta.data$expCond)
} else {
seuratObjFinal@meta.data$expCond <- seuratObjFinal@meta.data$expCond1
}
} else if (expCondCheck == 'expCond2') {
if (!'expCond2' %in% colnames(seuratObjFinal@meta.data)){
print("Error: 'expCond2' has not been included in the original integration analysis.")
seuratObjFinal@meta.data$expCond <- gsub(pattern = as.character(expCondName2change), replacement = '', x = seuratObjFinal@meta.data$expCond)
} else {
seuratObjFinal@meta.data$expCond <- seuratObjFinal@meta.data$expCond2
}
}
head(seuratObjFinal)
## ------
print(table(Idents(seuratObjFinal)))
expCondReorderLevels = c('F', 'A', 'I')
expCondReorderLevels
levels(factor(seuratObjFinal@meta.data$expCond))
levels(factor(seuratObjFinal$expCond, levels = expCondReorderLevels))
length(levels(factor(seuratObjFinal$expCond))) )
length(levels(factor(seuratObjFinal$expCond)))
levels(Idents(seuratObjFinal))
head(Idents(seuratObjFinal))
length(Idents(seuratObjFinal))
head(seuratObjFinal$expCond)
levels(Idents(seuratObjFinal)
)
length(paste(rep(levels(Idents(seuratObjFinal)), each = length(levels(factor(seuratObjFinal$expCond))) ), levels(factor(seuratObjFinal$expCond, levels = expCondReorderLevels)), sep = '_'))
levels(paste(Idents(seuratObjFinal), seuratObjFinal$expCond, sep = '_'))
levels(factor(paste(Idents(seuratObjFinal), seuratObjFinal$expCond, sep = '_')))
levels(paste(rep(levels(Idents(seuratObjFinal)), each = length(levels(factor(seuratObjFinal$expCond))) ), levels(factor(seuratObjFinal$expCond, levels = expCondReorderLevels)), sep = '_'))
levels(factor(paste(rep(levels(Idents(seuratObjFinal)), each = length(levels(factor(seuratObjFinal$expCond))) ), levels(factor(seuratObjFinal$expCond, levels = expCondReorderLevels)), sep = '_')))
expCondReorderLevels
length(paste(rep(levels(Idents(seuratObjFinal)), each = length(levels(factor(seuratObjFinal$expCond))) ), levels(factor(seuratObjFinal$expCond, levels = expCondReorderLevels)), sep = '_'))
head(paste(rep(levels(Idents(seuratObjFinal)), each = length(levels(factor(seuratObjFinal$expCond))) ), levels(factor(seuratObjFinal$expCond, levels = expCondReorderLevels)), sep = '_'))
head(levels(Idents(seuratObjFinal))
)
paste(rep(levels(Idents(seuratObjFinal)), each = length(levels(factor(seuratObjFinal$expCond))) ), levels(factor(seuratObjFinal$expCond, levels = expCondReorderLevels)), sep = '_')
if (expCondCheck != 'comb') {
Idents(seuratObjFinal)        <- factor( paste(Idents(seuratObjFinal), seuratObjFinal$expCond, sep = '_'),
levels = paste(rep(levels(Idents(seuratObjFinal)), each = length(levels(factor(seuratObjFinal$expCond))) ), levels(factor(seuratObjFinal$expCond, levels = expCondReorderLevels)), sep = '_') )
} else {
Idents(seuratObjFinal)        <- factor(Idents(seuratObjFinal), levels = expCondReorderLevels)
}
table(Idents(seuratObjFinal))
seuratObjFinal = seuratObjFinalOrg
table(Idents(seuratObjFinal))
## ------
if (expCondCheck == 'sample') {
seuratObjFinal                     <- seuratObjFinal
} else if (expCondCheck == 'comb') {
seuratObjFinal@meta.data$expCond   <- Idents(seuratObjFinal)
} else if (expCondCheck == 'expCond1') {
if (!'expCond1' %in% colnames(seuratObjFinal@meta.data)){
print("Error: 'expCond1' has not been included in the original integration analysis.")
seuratObjFinal@meta.data$expCond <- gsub(pattern = as.character(expCondName2change), replacement = '', x = seuratObjFinal@meta.data$expCond)
} else {
seuratObjFinal@meta.data$expCond <- seuratObjFinal@meta.data$expCond1
}
} else if (expCondCheck == 'expCond2') {
if (!'expCond2' %in% colnames(seuratObjFinal@meta.data)){
print("Error: 'expCond2' has not been included in the original integration analysis.")
seuratObjFinal@meta.data$expCond <- gsub(pattern = as.character(expCondName2change), replacement = '', x = seuratObjFinal@meta.data$expCond)
} else {
seuratObjFinal@meta.data$expCond <- seuratObjFinal@meta.data$expCond2
}
}
expCondReorderLevels          <- levels(factor(seuratObjFinal@meta.data$expCond))
Idents(seuratObjFinal)
table(Idents(seuratObjFinal) )
if (expCondCheck != 'comb') {
Idents(seuratObjFinal)        <- factor( paste(Idents(seuratObjFinal), seuratObjFinal$expCond, sep = '_'),
levels = paste(rep(levels(Idents(seuratObjFinal)), each = length(levels(factor(seuratObjFinal$expCond))) ), levels(factor(seuratObjFinal$expCond, levels = expCondReorderLevels)), sep = '_') )
} else {
Idents(seuratObjFinal)        <- factor(Idents(seuratObjFinal), levels = expCondReorderLevels)
}
table(Idents(seuratObjFinal) )
seuratObjFinal = seuratObjFinalOrg
seuratObjFinal@meta.data$expCond   <- Idents(seuratObjFinal)
expCondCheck = 'comb'
expCondReorderLevels          <- levels(factor(seuratObjFinal@meta.data$expCond))
if (expCondCheck != 'comb') {
Idents(seuratObjFinal)        <- factor( paste(Idents(seuratObjFinal), seuratObjFinal$expCond, sep = '_'),
levels = paste(rep(levels(Idents(seuratObjFinal)), each = length(levels(factor(seuratObjFinal$expCond))) ), levels(factor(seuratObjFinal$expCond, levels = expCondReorderLevels)), sep = '_') )
} else {
Idents(seuratObjFinal)        <- factor(Idents(seuratObjFinal), levels = expCondReorderLevels)
}
table(Idents(seuratObjFinal))
seuratObjFinal =  seuratObjFinalOrg
expCondCheck ='expCond1'
## ------
if (expCondCheck == 'sample') {
seuratObjFinal                     <- seuratObjFinal
} else if (expCondCheck == 'comb') {
seuratObjFinal@meta.data$expCond   <- Idents(seuratObjFinal)
} else if (expCondCheck == 'expCond1') {
if (!'expCond1' %in% colnames(seuratObjFinal@meta.data)){
print("Error: 'expCond1' has not been included in the original integration analysis.")
seuratObjFinal@meta.data$expCond <- gsub(pattern = as.character(expCondName2change), replacement = '', x = seuratObjFinal@meta.data$expCond)
} else {
seuratObjFinal@meta.data$expCond <- seuratObjFinal@meta.data$expCond1
}
} else if (expCondCheck == 'expCond2') {
if (!'expCond2' %in% colnames(seuratObjFinal@meta.data)){
print("Error: 'expCond2' has not been included in the original integration analysis.")
seuratObjFinal@meta.data$expCond <- gsub(pattern = as.character(expCondName2change), replacement = '', x = seuratObjFinal@meta.data$expCond)
} else {
seuratObjFinal@meta.data$expCond <- seuratObjFinal@meta.data$expCond2
}
}
expCondReorderLevels
levels(factor(seuratObjFinal@meta.data$expCond))
expCondReorderLevels <- c('I', 'A', 'F')
if (expCondCheck != 'comb') {
Idents(seuratObjFinal)        <- factor( paste(Idents(seuratObjFinal), seuratObjFinal$expCond, sep = '_'),
levels = paste(rep(levels(Idents(seuratObjFinal)), each = length(levels(factor(seuratObjFinal$expCond))) ), levels(factor(seuratObjFinal$expCond, levels = expCondReorderLevels)), sep = '_') )
} else {
Idents(seuratObjFinal)        <- factor(Idents(seuratObjFinal), levels = expCondReorderLevels)
}
table(Idents(seuratObjFinal)  )
seuratObjFinal = seuratObjFinalOrg
expCondCheck = 'expCond2'
## ------
if (expCondCheck == 'sample') {
seuratObjFinal                     <- seuratObjFinal
} else if (expCondCheck == 'comb') {
seuratObjFinal@meta.data$expCond   <- Idents(seuratObjFinal)
} else if (expCondCheck == 'expCond1') {
if (!'expCond1' %in% colnames(seuratObjFinal@meta.data)){
print("Error: 'expCond1' has not been included in the original integration analysis.")
seuratObjFinal@meta.data$expCond <- gsub(pattern = as.character(expCondName2change), replacement = '', x = seuratObjFinal@meta.data$expCond)
} else {
seuratObjFinal@meta.data$expCond <- seuratObjFinal@meta.data$expCond1
}
} else if (expCondCheck == 'expCond2') {
if (!'expCond2' %in% colnames(seuratObjFinal@meta.data)){
print("Error: 'expCond2' has not been included in the original integration analysis.")
seuratObjFinal@meta.data$expCond <- gsub(pattern = as.character(expCondName2change), replacement = '', x = seuratObjFinal@meta.data$expCond)
} else {
seuratObjFinal@meta.data$expCond <- seuratObjFinal@meta.data$expCond2
}
}
levels(factor(seuratObjFinal@meta.data$expCond))
expCondReorderLevels
## re-define Idents(seuratObjFinal) with level name: cluster + expCond if expCondCheck != 'comb'
## ---
if (is.null(expCondReorderLevels)) {
expCondReorderLevels          <- levels(factor(seuratObjFinal@meta.data$expCond))
}
if ( !all(expCondReorderLevels %in% levels(factor(seuratObjFinal$expCond))) ) stop("Please provide correct corresponding 'expCondReorderLevels' to sort y-axis dot plot")
expCondReorderLevels          <- levels(factor(seuratObjFinal@meta.data$expCond))
if ( !all(expCondReorderLevels %in% levels(factor(seuratObjFinal$expCond))) ) stop("Please provide correct corresponding 'expCondReorderLevels' to sort y-axis dot plot")
if (expCondCheck != 'comb') {
Idents(seuratObjFinal)        <- factor( paste(Idents(seuratObjFinal), seuratObjFinal$expCond, sep = '_'),
levels = paste(rep(levels(Idents(seuratObjFinal)), each = length(levels(factor(seuratObjFinal$expCond))) ), levels(factor(seuratObjFinal$expCond, levels = expCondReorderLevels)), sep = '_') )
} else {
Idents(seuratObjFinal)        <- factor(Idents(seuratObjFinal), levels = expCondReorderLevels)
}
table(Idents(seuratObjFinal))
library(devtools)
getwd()
document()
document()
setwd('..')
install('scRICA/')
setwd('scRICA/')
document()
document()
setwd('..')
install('scRICA/')
?cowplot::plot_grid
setwd('scRICA/')
document()
document()
setwd('..')
install('scRICA/')
length( levels(factor(Idents(seuratObjFinal))))
11*0.4
11*0.8
setwd('scRICA/')
document()
document()
setwd('..')
install('scRICA/')
21*0.25
21*0.4
21*0.45
25*0.4
25 < 25
25 > 24
setwd('scRICA/')
document()
document()
setwd('..')
install('scRICA/')
library(ggplot2)
setwd('scRICA/')
document()
document()
setwd('..')
install('scRICA/')
setwd('scRICA/')
document()
document()
setwd('..')
install('scRICA/')
setwd('scRICA/')
document()
document()
setwd('..')
install('scRICA/')
setwd('scRICA/')
document()
document()
21*0.4
setwd('..')
install('scRICA/')
setwd('scRICA/')
document()
document()
setwd('..')
install('scRICA/')
?ggsave
setwd('scRICA/')
document()
document()
setwd('..')
install('scRICA/')
?element_text
setwd('scRICA/')
document()
setwd('scRICA/')
document()
document()
setwd('..')
install('scRICA/')
setwd('scRICA/')
document()
document()
setwd('..')
install('scRICA/')
21*8
21*3
setwd('scRICA/')
document()
document()
setwd('..')
install('scRICA/')
setwd('scRICA/')
document()
document()
setwd('..')
install('scRICA/')
21.25/339.95
0.0625*139.99
139.99+8.75
?as.dendrogram
library(devtools)
document()
document()
document()
document()
document()
setwd('..')
install('scRICA/')
library(devtools)
document()
document()
document()
document()
setwd('..')
install('scRICA/')
setwd('scRICA/')
document()
document()
setwd('..')
install('scRICA/')
setwd('scRICA/')
document()
document()
setwd('..')
install('scRICA/')
setwd('scRICA/')
document()
document()
document()
document()
setwd('..')
install('scRICA/')
library(devtools)
document()
document()
document()
build_vignettes()
document()
document()
setwd('..')
install('scRICA/')
library(devtools)
library(devtools)
getwd()
library(devtools)
getwd()
setwd('..')
getwd()
setwd('testPackage/')
getwd()
library(devtools)
metadata                <- read.delim2(file = system.file('extdata', 'metadata_mac.txt', package = 'scRICA', mustWork = T), header = T)
system.file('extdata', 'metadata_mac.txt', package = 'scRICA', mustWork = T)
system.file()
system.file(package = 'scRICA')
?system.file
system.file('extdata/metadata_mac.txt', package = 'scRICA', mustWork = T)
list.files(system.file('extdata', package = 'scRICA', mustWork = T))
library(devtools)
build_vignettes()
vignette('scRICA')
setwd('..')
setwd('scRICA/')
document()
document()
setwd('..')
install('scRICA/')
library(scRICA)
vignette(scRICA)
vignette('scRICA')
?vignette
vignette(package = 'scRICA')
?browseVignettes()
browseVignettes(package = 'scRICA')
library(scRICA)
browseVignettes(package = 'scRICA')
library(devtools)
document()
usethis::use_vignette("my-vignette")
usethis::use_vignette("scRICA_v1")
devtools::build_vignettes()
library(scRICA)
browseVignettes(package = 'scRICA')
browseVignettes(package = 'scRICA')
library(scRICA)
browseVignettes(package = 'scRICA')
browseVignettes(package = 'scRICA')
browseVignettes(package = 'scRICA')
usethis::use_vignette("scRICA_v1")
devtools::build_vignettes()
browseVignettes(package = 'scRICA')
library(scRICA)
browseVignettes(package = 'scRICA')
browseVignettes(package = 'scRICA')
browseVignettes(package = 'scRICA')
browseVignettes(package = 'scRICA')
library(scRICA)
browseVignettes(package = 'scRICA')
devtools::build_vignettes()
devtools::build_vignettes()
devtools::document()
setwd('..')
library(devtools)
install('scRICA/')
browseVignettes(package = 'scRICA')
library(scRICA)
browseVignettes(package = 'scRICA')
browseVignettes(package = 'scRICA')
devtools::build_vignettes()
browseVignettes(package = 'scRICA')
library(scRICA)
browseVignettes(package = 'scRICA')
browseVignettes(package = 'scRICA')
getwd()
setwd('scRICA/')
library(devtools)
document()
browseVignettes(package = 'scRICA')
browseVignettes(package = 'scRICA')
browseVignettes(package = 'scRICA')
build_vignettes()
browseVignettes(package = 'scRICA')
browseVignettes(package = 'scRICA')
library(scRICA)
browseVignettes(package = 'scRICA')
browseVignettes(package = 'scRICA')
library(scRICA)
browseVignettes(package = 'scRICA')
browseVignettes(package = 'scRICA')
library(scRICA)
browseVignettes(package = 'scRICA')
getwd()
library(devtools)
build_vignettes()
browseVignettes(package = 'scRICA')
?build_vignettes
build_vignettes(pkg = 'scRICA')
browseVignettes(package = 'scRICA')
browseVignettes(package = 'scRICA')
library(scRICA)
browseVignettes('scRICA')
browseVignettes('scRICA')
browseVignettes()
browseVignettes('scRICA')
browseVignettes(package = 'scRICA')
getwd()
library(devtools)
build_vignettes()
browseVignettes()
library(scRICA)
browseVignettes()
browseVignettes(package = 'scRICA')
browseVignettes(package = 'scRICA')
library(scRICA)
browseVignettes(package = 'scRICA')
library(devtools)
getwd()
build_vignettes()
devtools::install(build_vignettes = TRUE)
browseVignettes(package = 'scRICA')
browseVignettes()
library(devtools)
# library(devtools)
# build_vignettes()
# devtools::install(build_vignettes = TRUE)
browseVignettes(package = 'scRICA)
''
'
browseVignettes(package = 'scRICA')
library(devtools)
devtools::install_github(repo = 'yan-cri/scRICA')
devtools::install_github(repo = 'yan-cri/scRICA', build_vignettes = T, force = T)
install.packages("leiden")
devtools::install_github(repo = 'yan-cri/scRICA', build_vignettes = T, force = T)
library("reticulate")
py_install("python-igraph")
py_install("leidenalg", forge = TRUE)
devtools::install_github(repo = 'yan-cri/scRICA', build_vignettes = T, force = T)
install.packages("leiden")
setwd('~/Desktop/scRICA/')
setwd('~/Desktop/scRICA/')
library(devtools)
setwd('..')
getwd()
devtools::install('scRICA/')
library(devtools)
document()
document()
library(Seurat)
install.packages("Seurat")
library(Seurat)
library(Seurat)
install.packages("Seurat")
library(SeuratObject)
library(Seurat)
install.packages('leiden')
devtools::install_github("TomKellyGenetics/leiden", ref = "master")
install.packages('leiden')
install.packages("leiden")
library(leiden)
install.packages('Seurat')
install.packages('remotes')
remotes::install_github(repo = 'satijalab/seurat', ref = 'develop')
library(scRICA)
remotes::install_version("Seurat", version = "4.0.1")
install.packages('~/Downloads/leiden_0.3.8.tgz',repos = NULL, type = 'source' )
install.packages("ggplotlyExtra")
install.packages('~/Downloads/leiden_0.3.8.tgz',repos = NULL, type = 'source' )
install.packages('~/Downloads/leiden_0.3.8.tgz',repos = NULL, type = 'source' )
library(leiden)
library(SeuratObject)
install.packages("Seurat")
library(Seurat)
library(Seurat)
getwd()
library(devtools)
setwd()
setwd('..')
document()
setwd('scRICA/')
document()
document()
build_vignettes()
setwd('..')
install('scRICA/')
library(scRICA)
?processQC
browseVignettes('scRICA')
getwd()
install('/Users/yanli/Desktop/scRIC_development/scRICA/', build_vignettes = T)
# devtools::install('scRICA', build_vignettes = T)
browseVignettes(package = 'scRICA')
metadata <- read.delim2(file = system.file('extdata', 'metadata_mac.txt', package = 'scRICA', mustWork = T), header = T)
head(metadata)
metadata
library(scRICA)
?processQC
library(scRICA)
?processQC
library(devtools)
build_vignettes()
